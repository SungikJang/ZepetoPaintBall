fileFormatVersion: 2
guid: d83ad6c5b971d1948be8786e1faa3875
importerOverride: ZEPETO.Script.Compiler:ZEPETO.Script:TypescriptAssetImporter
ScriptedImporter:
  internalIDToNameTable: []
  externalObjects: {}
  serializedVersion: 2
  userData: 
  assetBundleName: 
  assetBundleVariant: 
  script: {fileID: -1123457745, guid: 54cf806323ffe4418a4ce4cc63fe6b9d, type: 3}
  isAssemblyDeclarations: 0
  assembly: 
  generateAllTypes: 1
  types: []
  generateWrapper: 0
  overrideWrapperTypes: 0
  wrapperTypes: []
  WrapperFilters: []
  wrapperOutputDirectory: Generated
  compiledResult: '{"source":"\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\",
    { value: true });\r\nconst ZEPETO_Script_1 = require(\"ZEPETO.Script\");\r\nconst
    ZEPETO_Product_1 = require(\"ZEPETO.Product\");\r\nconst UnityEngine_1 = require(\"UnityEngine\");\r\nconst
    Manager_1 = require(\"../Manager/Manager\");\r\nconst ZEPETO_Currency_1 = require(\"ZEPETO.Currency\");\r\nconst
    Enums_1 = require(\"../Enums\");\r\nconst ZEPETO_Inventory_1 = require(\"ZEPETO.Inventory\");\r\nconst
    Connector_1 = require(\"./Connector\");\r\nconst index_1 = require(\"../Utils/index\");\r\nconst
    MyPlayerController_1 = require(\"../MyPlayerController/MyPlayerController\");\r\nclass
    ProductSync extends ZEPETO_Script_1.ZepetoScriptBehaviour {\r\n    Start() {\r\n       
    this.StartCoroutine(this.LoadAllItems()); //ItemsCache Product\r\n        //this.StartRefreshBalance();\r\n   
    }\r\n    *LoadAllItems() {\r\n        const request = ZEPETO_Product_1.ProductService.GetProductsAsync();\r\n       
    yield new UnityEngine_1.WaitUntil(() => request.keepWaiting == false);\r\n       
    while (true) {\r\n            if (Manager_1.default && Manager_1.default.Product)
    {\r\n                Manager_1.default.Product.ProductSyncinstance = this;\r\n               
    Manager_1.default.Product.SetMultiPlay(this.multiplay);\r\n                if
    (request.responseData.isSuccess) {\r\n                    Manager_1.default.Product.ItemsCache
    = [];\r\n                    request.responseData.products.forEach((pr) => {\r\n                       
    if (pr.ProductType == ZEPETO_Product_1.ProductType.Item) {\r\n                           
    Manager_1.default.Product.ItemsCache.push(pr);\r\n                        }\r\n                       
    if (pr.ProductType == ZEPETO_Product_1.ProductType.ItemPackage) {\r\n                           
    Manager_1.default.Product.ItemsPackageCache.push(pr);\r\n                       
    }\r\n                        if (pr.ProductType == ZEPETO_Product_1.ProductType.CurrencyPackage)
    {\r\n                            Manager_1.default.Product.CurrencyPackageCache.push(pr);\r\n                       
    }\r\n                    });\r\n                    if (Manager_1.default.Product.ItemsCache.length
    == 0) {\r\n                        console.warn(\"no Item information\");\r\n                       
    return;\r\n                    }\r\n                    return;\r\n               
    }\r\n                else {\r\n                    console.warn(\"Product Load
    Failed\");\r\n                }\r\n            }\r\n            yield new UnityEngine_1.WaitForSeconds(0.2);\r\n       
    }\r\n    }\r\n    *OnClickPurchaseItemImmediately(productId) {\r\n        const
    request = ZEPETO_Product_1.ProductService.PurchaseProductAsync(productId);\r\n       
    yield new UnityEngine_1.WaitUntil(() => request.keepWaiting == false);\r\n       
    if (request.responseData.isSuccess) {\r\n            // is purchase success\r\n       
    }\r\n        else {\r\n            // is purchase fail\r\n        }\r\n    }\r\n   
    *RefreshBalance() {\r\n        const request = ZEPETO_Currency_1.CurrencyService.GetUserCurrencyBalancesAsync();\r\n       
    yield new UnityEngine_1.WaitUntil(() => request.keepWaiting == false);\r\n       
    if (request.responseData.isSuccess) {\r\n            let g = request.responseData.currencies?.ContainsKey(Enums_1.Currency.Gold)
    ? request.responseData.currencies?.get_Item(Enums_1.Currency.Gold).toString()
    : \"0\";\r\n            MyPlayerController_1.default.Data.MyGold = Number(g);\r\n           
    let d = request.responseData.currencies?.ContainsKey(Enums_1.Currency.Diamond)
    ? request.responseData.currencies?.get_Item(Enums_1.Currency.Diamond).toString()
    : \"0\";\r\n            MyPlayerController_1.default.Data.MyDia = Number(d);\r\n       
    }\r\n    }\r\n    *RefreshOfficialCurrencyUI() {\r\n        console.log(''ocasrg546yujdfygkghilo'');\r\n       
    const request = ZEPETO_Currency_1.CurrencyService.GetOfficialCurrencyBalanceAsync();\r\n       
    yield new UnityEngine_1.WaitUntil(() => request.keepWaiting == false);\r\n       
    let z = request.responseData.currency.quantity.toString();\r\n        MyPlayerController_1.default.Data.MyZem
    = Number(z);\r\n    }\r\n    StartRefreshBalance() {\r\n        this.StartCoroutine(this.RefreshBalance());\r\n       
    this.StartCoroutine(this.RefreshOfficialCurrencyUI());\r\n    }\r\n    StartRefreshInventory()
    {\r\n        this.StartCoroutine(this.RefreshInventory());\r\n    }\r\n    *RefreshInventory()
    {\r\n        console.log(''inv'');\r\n        const request = ZEPETO_Inventory_1.InventoryService.GetListAsync();\r\n       
    yield new UnityEngine_1.WaitUntil(() => request.keepWaiting == false);\r\n       
    if (request.responseData.isSuccess) {\r\n            const items = request.responseData.products;\r\n           
    items.forEach((ir, index) => {\r\n                if (ir.productId.includes(\"gun\"))
    {\r\n                    let ind = Number(index_1.default.ExtractNumberStr(ir.productId));\r\n                   
    MyPlayerController_1.default.Data.MyWeaponInfoArr[ind - 1] = \"O\";\r\n               
    }\r\n            });\r\n            // items.forEach((ir, index) => {\r\n           
    //     // If there are zero consumable items, delete them from the inventory.\r\n           
    //     if (ir.quantity <= 0 && Manager.Product.ProductCache.get(ir.productId).PurchaseType
    == PurchaseType.Consumable) {\r\n            //         // remove inventory\r\n           
    //         const data = new RoomData();\r\n            //         data.Add(\"productId\",
    ir.productId);\r\n            //         Connector.Instance.ReqToServer(\"onRemoveInventory\",
    {productId: ir.productId});\r\n            //         return;\r\n           
    //     }\r\n            //\r\n            // });\r\n        }\r\n    }\r\n}\r\nexports.default
    = ProductSync;\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUHJvZHVjdFN5bmMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJQcm9kdWN0U3luYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLGlEQUFxRDtBQUNyRCxtREFBZ0c7QUFDaEcsNkNBQXNEO0FBQ3RELGdEQUF5QztBQUN6QyxxREFBZ0Q7QUFDaEQsb0NBQW9DO0FBQ3BDLHVEQUFtRTtBQUVuRSwyQ0FBb0M7QUFDcEMsMENBQWtDO0FBRWxDLGlGQUEwRTtBQUUxRSxNQUFxQixXQUFZLFNBQVEscUNBQXFCO0lBSTFELEtBQUs7UUFDRCxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQyxDQUFBLENBQUEsb0JBQW9CO1FBQzVELDZCQUE2QjtJQUNqQyxDQUFDO0lBR00sQ0FBRSxZQUFZO1FBQ2pCLE1BQU0sT0FBTyxHQUFHLCtCQUFjLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztRQUNsRCxNQUFNLElBQUksdUJBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUMsV0FBVyxJQUFJLEtBQUssQ0FBQyxDQUFDO1FBQ3hELE9BQU0sSUFBSSxFQUFDO1lBQ1AsSUFBRyxpQkFBTyxJQUFJLGlCQUFPLENBQUMsT0FBTyxFQUFDO2dCQUMxQixpQkFBTyxDQUFDLE9BQU8sQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLENBQUM7Z0JBQzNDLGlCQUFPLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUE7Z0JBQzVDLElBQUksT0FBTyxDQUFDLFlBQVksQ0FBQyxTQUFTLEVBQUU7b0JBQ2hDLGlCQUFPLENBQUMsT0FBTyxDQUFDLFVBQVUsR0FBRyxFQUFFLENBQUM7b0JBQ2hDLE9BQU8sQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQUUsRUFBRSxFQUFFO3dCQUN6QyxJQUFJLEVBQUUsQ0FBQyxXQUFXLElBQUksNEJBQVcsQ0FBQyxJQUFJLEVBQUU7NEJBQ3BD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","assetPath":"Assets/Scripts/Client/Network/ProductSync.ts","manifest":{"properties":[{"assembly":"ZEPETO.World","name":"multiplay","type":"ZEPETO.World.ZepetoWorldMultiplay","isArray":false,"initValue":[],"enumKeys":[],"enumValues":[],"attributes":[]}],"name":"ProductSync","description":"","hasAnimatorMove":false},"isCompiled":true}'
  typescriptHash: 8976ebfb4ba92b0e2eda2f175f3091cd
  onlyWriteTrigger: 0
