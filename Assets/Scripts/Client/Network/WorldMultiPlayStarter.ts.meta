fileFormatVersion: 2
guid: f326422950291bf4fa39c9142833adba
importerOverride: ZEPETO.Script.Compiler:ZEPETO.Script:TypescriptAssetImporter
ScriptedImporter:
  internalIDToNameTable: []
  externalObjects: {}
  serializedVersion: 2
  userData: 
  assetBundleName: 
  assetBundleVariant: 
  script: {fileID: -1123457745, guid: 54cf806323ffe4418a4ce4cc63fe6b9d, type: 3}
  isAssemblyDeclarations: 0
  assembly: 
  generateAllTypes: 1
  types: []
  generateWrapper: 0
  overrideWrapperTypes: 0
  wrapperTypes: []
  WrapperFilters: []
  wrapperOutputDirectory: Generated
  compiledResult: "{\"source\":\"\\\"use strict\\\";\\r\\nObject.defineProperty(exports,
    \\\"__esModule\\\", { value: true });\\r\\nconst ZEPETO_Script_1 = require(\\\"ZEPETO.Script\\\");\\r\\nconst
    ZEPETO_World_1 = require(\\\"ZEPETO.World\\\");\\r\\nconst ZEPETO_Character_Controller_1
    = require(\\\"ZEPETO.Character.Controller\\\");\\r\\nconst UnityEngine_1 = require(\\\"UnityEngine\\\");\\r\\nconst
    IOC_1 = require(\\\"../IOC\\\");\\r\\nconst MyPlayerTriggerController_1 = require(\\\"../MyPlayer/MyPlayerTriggerController\\\");\\r\\nconst
    MyPalyerController_1 = require(\\\"../MyPlayer/MyPalyerController\\\");\\r\\nclass
    WorldMultiPlayStarter extends ZEPETO_Script_1.ZepetoScriptBehaviour {\\r\\n   
    constructor() {\\r\\n        super(...arguments);\\r\\n        this.isAdmin =
    false;\\r\\n        this._currentPlayers = new Map();\\r\\n    }\\r\\n    static
    get Instance() {\\r\\n        if (!WorldMultiPlayStarter._instance) {\\r\\n           
    const go = UnityEngine_1.GameObject.Find('WorldMultiPlayStarter');\\r\\n           
    WorldMultiPlayStarter._instance = go.GetComponent($typeof(WorldMultiPlayStarter));\\r\\n       
    }\\r\\n        return WorldMultiPlayStarter._instance;\\r\\n    }\\r\\n    get
    Room() {\\r\\n        return this._room;\\r\\n    }\\r\\n    set Room(r) {\\r\\n       
    this._room = r;\\r\\n    }\\r\\n    Start() {\\r\\n        this.StartCoroutine(this.SetMultiPlay());\\r\\n   
    }\\r\\n    OnStateChange(state, isFirst) {\\r\\n        if (isFirst) {\\r\\n           
    // \uC11C\uBC84\uC5D0\uC11C state\uAC00 \uCC98\uC74C\uC73C\uB85C \uBCC0\uD654\uD560
    \uB54C \uC774\uBCA4\uD2B8 \uB9AC\uC2A4\uB108\uB97C \uC815\uC758\uD55C\uB2E4\\r\\n           
    ZEPETO_Character_Controller_1.ZepetoPlayers.instance.OnAddedPlayer.AddListener((sessionId)
    => {\\r\\n                // \uD50C\uB808\uC774\uC5B4\uB97C \uC0DD\uC131\uD558\uBA74
    \uC2E4\uD589\uB41C\uB2E4\\r\\n                const player = ZEPETO_Character_Controller_1.ZepetoPlayers.instance.GetPlayer(sessionId);\\r\\n               
    player.character.name = sessionId;\\r\\n            });\\r\\n            ZEPETO_Character_Controller_1.ZepetoPlayers.instance.OnAddedLocalPlayer.AddListener(()
    => {\\r\\n                ZEPETO_Character_Controller_1.ZepetoPlayers.instance.LocalPlayer.zepetoPlayer.character.gameObject.AddComponent($typeof(MyPlayerTriggerController_1.default));\\r\\n               
    IOC_1.default.Instance.getInstance(MyPalyerController_1.MyPlayerController).MyPlayerData.SetMyPlayer();\\r\\n               
    IOC_1.default.Instance.getInstance(MyPalyerController_1.MyPlayerController).MyPlayerMovement.SetMyPlayer();\\r\\n           
    });\\r\\n        }\\r\\n        if (state.players.Count === 1) {\\r\\n           
    this.isAdmin = true;\\r\\n        }\\r\\n        let JoinPlayers = new Map();\\r\\n       
    let leavePlayers = new Map(this._currentPlayers);\\r\\n        state.players.ForEach((sessionId,
    gemtoryPlayer) => {\\r\\n            if (!this._currentPlayers.has(sessionId))
    {\\r\\n                JoinPlayers.set(sessionId, gemtoryPlayer);\\r\\n           
    }\\r\\n            leavePlayers.delete(sessionId);\\r\\n        });\\r\\n       
    JoinPlayers.forEach((gemtoryPlayer, sessionId) => this.OnJoinPlayer(sessionId,
    gemtoryPlayer));\\r\\n        leavePlayers.forEach((gemtoryPlayer, sessionId)
    => this.OnLeavePlayer(sessionId, gemtoryPlayer));\\r\\n    }\\r\\n    OnJoinPlayer(sessionId,
    gemtoryPlayer) {\\r\\n        this._currentPlayers.set(sessionId, gemtoryPlayer);\\r\\n       
    const spawnInfo = new ZEPETO_Character_Controller_1.SpawnInfo();\\r\\n       
    spawnInfo.position = new UnityEngine_1.Vector3(0, 0, 0);\\r\\n        spawnInfo.rotation
    = UnityEngine_1.Quaternion.Euler(0, 0, 0);\\r\\n        $extension(\\\"ZEPETO.Character.Controller.ZepetoPlayersExtension\\\").CreatePlayerWithUserId(ZEPETO_Character_Controller_1.ZepetoPlayers.instance,
    sessionId, gemtoryPlayer.userId, spawnInfo, this._room.SessionId === gemtoryPlayer.sessionId);\\r\\n   
    }\\r\\n    OnLeavePlayer(sessionId, gemtoryPlayer) {\\r\\n        const leavePlayer
    = ZEPETO_Character_Controller_1.ZepetoPlayers.instance.GetPlayer(sessionId);\\r\\n       
    this._currentPlayers.delete(sessionId);\\r\\n        ZEPETO_Character_Controller_1.ZepetoPlayers.instance.RemovePlayer(sessionId);\\r\\n   
    }\\r\\n    *SetMultiPlay() {\\r\\n        while (true) {\\r\\n            this._multiplay
    = UnityEngine_1.GameObject.Find(\\\"WorldMultiPlay\\\").GetComponent($typeof(ZEPETO_World_1.ZepetoWorldMultiplay));\\r\\n           
    if (this._multiplay) {\\r\\n                this._multiplay.add_RoomCreated((room)
    => {\\r\\n                    this._room = room;\\r\\n                });\\r\\n               
    this._multiplay.add_RoomJoined((room) => {\\r\\n                    room.add_OnStateChange(this.OnStateChange.bind(this));\\r\\n               
    });\\r\\n                console.log('MultiplaySetCompleted');\\r\\n               
    return;\\r\\n            }\\r\\n            yield new UnityEngine_1.WaitForSeconds(0.1);\\r\\n       
    }\\r\\n    }\\r\\n}\\r\\nexports.default = WorldMultiPlayStarter;\\r\\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiV29ybGRNdWx0aVBsYXlTdGFydGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiV29ybGRNdWx0aVBsYXlTdGFydGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsaURBQXFEO0FBQ3JELCtDQUFtRDtBQUduRCw2RUFBcUU7QUFDckUsNkNBT3FCO0FBQ3JCLGdDQUF5QjtBQUN6QixxRkFBOEU7QUFDOUUsdUVBQW9FO0FBRXBFLE1BQXFCLHFCQUFzQixTQUFRLHFDQUFxQjtJQUF4RTs7UUFlWSxZQUFPLEdBQVksS0FBSyxDQUFDO1FBRXpCLG9CQUFlLEdBQXdCLElBQUksR0FBRyxFQUFrQixDQUFDO0lBc0Y3RSxDQUFDO0lBcEdVLE1BQU0sS0FBSyxRQUFRO1FBQ3RCLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxTQUFTLEVBQUU7WUFDbEMsTUFBTSxFQUFFLEdBQUcsd0JBQVUsQ0FBQyxJQUFJLENBQUMsdUJBQXVCLENBQUMsQ0FBQztZQUNwRCxxQkFBcUIsQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDLFlBQVksU0FBQyxxQkFBcUIsRUFBRyxDQUFDO1NBQzlFO1FBQ0QsT0FBTyxxQkFBcUIsQ0FBQyxTQUFTLENBQUM7SUFDM0MsQ0FBQztJQVVELElBQVcsSUFBSTtRQUNYLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQztJQUN0QixDQUFDO0lBQ0QsSUFBVyxJQUFJLENBQUMsQ0FBTztRQUNuQixJQUFJLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQztJQUNuQixDQUFDO0lBRUQsS0FBSztRQUNELElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDLENBQUM7SUFDN0MsQ0FBQztJQUVPLGFBQWEsQ0FBQyxLQUFZLEVBQUUsT0FBZ0I7UUFDaEQsSUFBSSxPQUFPLEVBQUU7WUFDVCx1Q0FBdUM7WUFDdkMsMkNBQWEsQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxDQUFDLFNBQWlCLEVBQUUsRUFBRTtn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\",\"assetPath\":\"Assets/Scripts/Client/Network/WorldMultiPlayStarter.ts\",\"manifest\":{\"properties\":[],\"name\":\"WorldMultiPlayStarter\",\"description\":\"\",\"hasAnimatorMove\":false},\"isCompiled\":true}"
  typescriptHash: 593778c730d239ba2703a7533aff1a3b
  onlyWriteTrigger: 0
